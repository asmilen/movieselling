@model Manage.Models.Schedule

@{
    ViewBag.Title = "View Schedule ";
}

<ul id="menu">
    <li>@Html.ActionLink("Add Schedule ", "Add")</li>
    <li>@Html.ActionLink("View Schedule ", "ViewSche")</li>
</ul>

@Html.ValidationSummary()
<section class="Schedule">
@using (Html.BeginForm("ViewSche", "ManageSchedule", FormMethod.Post, new { enctype = "multipart/form-data"}))
                {
    <table>
        <tr>
            <td> @Html.EditorFor(m => m.DateSche) </td>

            <td width="10px">
               
                    @Html.AntiForgeryToken()
                    <input type="submit" value="View" width="10px" />
            </td>
        </tr>
    </table>
}
 
        @foreach (var item in Model.listScheduleByFilm)
{

    // Select ten film theo film ID
    System.Data.SqlClient.SqlConnection conn = new System.Data.SqlClient.SqlConnection(System.Web.Configuration.WebConfigurationManager.ConnectionStrings["myConnectionString"].ConnectionString);
    string sqlSelect = @"select Name from Room where RoomID = " + item.Key;
    System.Data.SqlClient.SqlCommand cmd = new System.Data.SqlClient.SqlCommand(sqlSelect, conn);
    conn.Open();
    System.Data.SqlClient.SqlDataReader reader = cmd.ExecuteReader();
    if (reader.Read())
    {
        <table>
            <tr>
                <th> @reader["Name"] </th>
            </tr>
            @foreach (var sche in item.Value)
{
    <tr>
        <td> @Html.ActionLink(sche.startTime, "Edit", new { sche.ScheduleID }) </td>
        @{
            sqlSelect = @"select Name from Film where FilmID = " + sche.FilmID;
            System.Data.SqlClient.SqlCommand cmd1 = new System.Data.SqlClient.SqlCommand(sqlSelect, conn);
            System.Data.SqlClient.SqlDataReader reader1 = cmd.ExecuteReader();
            if (reader1.Read())
            {
                <td> @Html.ActionLink(reader["Name"].ToString(), "Edit", new { sche.ScheduleID }) </td>
            }
        }
    </tr>
}
        </table>
    }
    conn.Close();
    conn.Dispose();
}

</section>



